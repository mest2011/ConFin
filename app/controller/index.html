<!-- <html>

<head lang="pt-br">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Envio de Arquivos</title>
    </head>

<body>
    <form action="usuario_controller.php" method="post" enctype="multipart/form-data">
        <h2>Envio de Arquivos</h2>

        Foto: 
        <input type="file" name="file" accept=".jpg, .jpeg">
        <br>
        Ficha MÃ©dica:
        <input type="text" name="id" value="1">
        <input type="text" name="funcao" value="salvarfoto">
        <hr>
        <input type="submit" value="Enviar">
    </form>
</body>

</html> -->


<!DOCTYPE html>
<html>

<head>
    <title>Upload</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>

<body>

    <h1>Upload!</h1>

    <div>
        <div class="form-group">
            <label for="upfile-2">Profile Picture</label>
            <input type="file" class="form-control" id="upfile-2" accept=".jpg">
        </div>
        <div class="form-group">
            <button id="upload" class="btn btn-outline-primary">Upload</button>
        </div>
    </div>

    <script type="text/javascript">
        const uploadButton = document.querySelector('#upload');

        var myHeaders = new Headers();
        //myHeaders.append("post", `funcao=salvarfoto&id=1&tipo=none`);

        uploadButton.addEventListener('click', () => {
            const form = new FormData();

            const file = document.querySelector('#upfile-2').files[0];
            form.append('foto', file);
            form.append("funcao", "salvarfoto");
            form.append("id", "1");
            form.append("tipo", "none");

            const url = './usuario_controller.php'
            const request = new Request(url, {
                method: 'POST',
                headers: myHeaders,
                body: form
            });

            fetch(request)
                .then(response => response.json())
                .then(console.log)
                .catch(error => console.log(error))
        });


    </script>

</body>

</html>